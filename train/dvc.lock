schema: '2.0'
stages:
  get_data:
    cmd:
    - mkdir -p data
    - wget 
      https://github.com/theislab/DeepCollisionalCrossSection/blob/master/data/combined_sm.csv.tar.gz\?raw\=true
      -O ccs_data.csv.tar.gz
    - tar -xzf ccs_data.csv.tar.gz
    - mv combined_sm.csv ./data/ccs_data.csv
    outs:
    - path: data/ccs_data.csv
      hash: md5
      md5: 85eadec26a4f8021efe027228e131164
      size: 59926681
  get_pride_data:
    cmd:
    - mkdir -p data
    - wget -c 
      ftp://ftp.pride.ebi.ac.uk/pride/data/archive/2022/08/PXD034640/IM-GPF_library.tsv
    - mv IM-GPF_library.tsv ./data/.
    - wget -c ftp://ftp.pride.ebi.ac.uk/pride/data/archive/2022/08/PXD034640/Deep_Library.tsv
    - mv Deep_Library.tsv ./data/.
    outs:
    - path: data/Deep_Library.tsv
      hash: md5
      md5: ad3752a62402d7f0e8debe8311fcba10
      size: 2967497400
    - path: data/IM-GPF_library.tsv
      hash: md5
      md5: a593e1ed05169d06204bb4fe2614c0a6
      size: 313154814
  train_ook0_model:
    cmd:
    - python scripts/train_1ok0.py
    deps:
    - path: data/Deep_Library.tsv
      hash: md5
      md5: ad3752a62402d7f0e8debe8311fcba10
      size: 2967497400
    outs:
    - path: plots/one_over_k0_model_feature_importance.png
      hash: md5
      md5: d792f8ead2b74b09f7488139a73500d0
      size: 27116
    - path: plots/one_over_k0_model_ims_error.png
      hash: md5
      md5: 9290aa16250e3ec894b2a24425f9779c
      size: 185951
    - path: plots/one_over_k0_model_ims_error_cumulative.png
      hash: md5
      md5: 6b728e687892073ac0c52a53fbf16af8
      size: 42422
    - path: plots/one_over_k0_model_ims_error_hist.png
      hash: md5
      md5: 0713ac1d88eb722c760166feeaf48033
      size: 28753
    - path: plots/one_over_k0_model_ims_pred_vs_true.png
      hash: md5
      md5: 4030591136bd794f54fb93b7b82ba8b5
      size: 90256
    - path: plots/one_over_k0_model_metrics.toml
      hash: md5
      md5: f7bfae37c7d383b4ab9c39882e1f4698
      size: 66
    - path: weights/one_over_k0_model.txt
      hash: md5
      md5: 9e5edf4df5f1c040a46d189e1a87c6f6
      size: 1953792
  train_ccs_model:
    cmd:
    - python scripts/train_ccs.py
    deps:
    - path: data/ccs_data.csv
      hash: md5
      md5: 85eadec26a4f8021efe027228e131164
      size: 59926681
    outs:
    - path: plots/ccs_cumulative_error.png
      hash: md5
      md5: d55ac7091f979e9e1d2e3a1e03b5bab2
      size: 39896
    - path: plots/ccs_error.png
      hash: md5
      md5: 4245cfaac5af35b1dd74facf7399ea04
      size: 17332
    - path: plots/ccs_feature_importance.png
      hash: md5
      md5: 0a1144cb2cd14c095a7dc4fafc18f494
      size: 28480
    - path: plots/ccs_model_metrics.toml
      hash: md5
      md5: e84f8eed3282d01f368e4276710bd5b3
      size: 59
    - path: plots/ccs_mz_vs_error.png
      hash: md5
      md5: d5e48a93d5ad1d7a009c6b74992ff5e5
      size: 116044
    - path: plots/ccs_predicted_vs_real.png
      hash: md5
      md5: a85ceed8b8769c357fce615e6ea122a9
      size: 72758
    - path: weights/ccs_model.txt
      hash: md5
      md5: 394871cac745ee1969807b3683c9423b
      size: 1646570
